[build]
  functions = "netlify/functions"
  publish = "."

# -------------------------------
# 代理计数服务 (Counter.dev)
# -------------------------------

# 脚本文件代理
[[redirects]]
  from = "/counter/script.js"
  to = "https://cdn.counter.dev/script.js"
  status = 200
  force = true

# --- GET track 请求直接代理 ---
[[redirects]]
  from = "/counter/track"
  to = "https://t.counter.dev/track"
  status = 200
  force = true
  query = { "*" = "*" }

# --- POST trackpage 请求，交由函数处理 ---
[[redirects]]
  from = "/counter/trackpage"
  to = "/.netlify/functions/counter-proxy/trackpage"
  status = 200
  force = true
  methods = ["POST"]

